<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Species threats</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Macroecology and global change</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: macroecological analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="a0_setup.html">0. Getting started</a>
    </li>
    <li>
      <a href="a1_SpatialData.html">1. Spatial data in R</a>
    </li>
    <li>
      <a href="a2_RichnessGradients.html">2. Species richness gradients</a>
    </li>
    <li>
      <a href="a3_RichnessRegression.html">3. Species richness regression</a>
    </li>
    <li>
      <a href="a4_RangeMaps.html">4. Species range maps</a>
    </li>
    <li>
      <a href="a5_SpeciesThreats.html">5. Species threats</a>
    </li>
    <li>
      <a href="a6_BiodivChanges.html">6. Analysing biodiversity changes</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: species distribution modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="b1_SpeciesData.html">1. Species data</a>
    </li>
    <li>
      <a href="b2_EnvData.html">2. Environmental data</a>
    </li>
    <li>
      <a href="b3_SDM_intro.html">3. SDMs: simple model fitting</a>
    </li>
    <li>
      <a href="b4_SDM_eval.html">4. SDMs: assessment and prediction</a>
    </li>
    <li>
      <a href="b5_pseudoabsence.html">5. Pseudo-absence and background data</a>
    </li>
    <li>
      <a href="b6_SDM_algorithms.html">6. SDMs: algorithms</a>
    </li>
    <li>
      <a href="b7_SDM_ensembles.html">7. SDMs: ensembles</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uni-potsdam.de/en/ibb-macroecology/index">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Species threats</h1>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<hr />
<div class="alert alert-info">
<p><strong>RStudio project</strong></p>
<p>Open the RStudio project that we created in the first session. I
recommend to use this RStudio project for the entire course and within
the RStudio project create separate R scripts for each session.</p>
<ul>
<li>Create a new empty R script by going to the tab “File”, select “New
File” and then “R script”</li>
<li>In the new R script, type <code># Session a5: Species threats</code>
and save the file in your folder “scripts” within your project folder,
e.g. as “a5_SpeciesThreats.R”</li>
</ul>
</div>
<p>The IUCN Red List of threatened species is a useful resource when
analysing diversity changes, species range changes and population
changes: www.iucnredlist.org <span class="citation">(IUCN 2019)</span>.
It provides information on the global conservation status of species,
specifically of animals, fungi and plant species. The IUCN has defined a
set of criteria to evaluate the extinction risk of species. According to
these criteria, species are classified into nine different categories
although strictly only five categories describe the conservation status
- from least concern to critically endangered [Fig. 1; <span
class="citation">IUCN (2012)</span>].</p>
<div class="figure">
<img src="figures/redlist.png" alt="**Figure 1. The IUCN red list categories. Adapted from [@IUCN2012].**" width="70%" />
<p class="caption">
<strong>Figure 1. The IUCN red list categories. Adapted from <span
class="citation">(IUCN 2012)</span>.</strong>
</p>
</div>
<p>The IUCN distinguishes five criteria that are used to classify
species into one of the three threatened categories (Fig. 1; <span
class="citation">IUCN (2012)</span>):</p>
<ul>
<li>A. Population size reduction</li>
<li>B. Extent of occurrence (B1) or Area of occupancy (B2)</li>
<li>C. Small population size and decline</li>
<li>D. Very small or restricted population</li>
<li>E. Quantitative analysis (probability of extinction within next 100
years)</li>
</ul>
<p>All of these information (the red list category, the relevant
assessment criteria, the population trends, etc.) are provided by the
IUCN. We can look at all these information online, e.g. for the <a
href="https://www.iucnredlist.org/species/22728432/132658315#conservation-actions">Balearic
Shearwater</a>.</p>
<p>Of course, if you want to analyse your species data in light of these
IUCN assessments, it can become very tedious to look up all information
by hand. The IUCN red list team provides an API for this purpose, and
the R package <code>rredlist</code> is a client to access this <a
href="http://apiv3.iucnredlist.org/api/v3/docs">IUCN red list API</a>.
It requires an <a href="http://apiv3.iucnredlist.org/api/v3/docs">API
key / a token</a> to use the API. You have to indicate your research
objectives for using the API.</p>
<p>I have got permission to use some red list information for the UK
breeding birds in class, but I am not allowed to post them. Thus, course
participants can download the data (<em>UK_birds_redlist_status.csv</em>
and <em>UK_birds_redlist_threats.csv</em>) in the secured moodle folder
(but please be aware that the <a
href="https://www.iucnredlist.org/terms/terms-of-use">IUCN terms of
use</a> apply!). External readers are advised to generate an API
token:</p>
<pre class="r"><code>library(rredlist)
# Generate your personal API token
rl_use_iucn()</code></pre>
<p>We will work with the UK breeding bird data from practical 3
available <a
href="https://damariszurell.github.io/EEC-Macro/data/UK_BBatlas_2008.csv">here</a>.
If not already done so, please download the data and save them in an
appropriate folder (e.g. in <em>data</em> folder).</p>
<pre class="r"><code># Read in the distribution dataset:
bird_dist &lt;- read.table(&#39;data/UK_BBatlas_2008.csv&#39;,header=T, sep=&#39;,&#39;, stringsAsFactors = F)

# Species names are contained in the columns:
spp &lt;- names(bird_dist)[-c(1:3)]

# For later usage, we need to remove the underscore in the names:
spp &lt;- sub(&#39;_&#39;,&#39; &#39;,spp)</code></pre>
<div id="iucn-red-list-categories" class="section level1" number="1">
<h1><span class="header-section-number">1</span> IUCN Red list
categories</h1>
<p>If you have your own IUCN API key, you can easily download the
information on species’ red list categories:</p>
<pre class="r"><code># Download red list category for single species using your personal API token &quot;MY_IUCN_REDLIST_KEY&quot;
(rl_search(&#39;Gavia stellata&#39;, key= MY_IUCN_REDLIST_KEY))</code></pre>
<pre><code>## $name
## [1] &quot;Gavia stellata&quot;
## 
## $result
##    taxonid scientific_name  kingdom   phylum class       order   family genus
## 1 22697829  Gavia stellata ANIMALIA CHORDATA  AVES GAVIIFORMES GAVIIDAE Gavia
##    main_common_name           authority published_year assessment_date category
## 1 Red-throated Loon (Pontoppidan, 1763)           2018      2018-08-07       LC
##   criteria population_trend marine_system freshwater_system terrestrial_system
## 1       NA       Decreasing          TRUE              TRUE               TRUE
##                 assessor        reviewer aoo_km2  eoo_km2 elevation_upper
## 1 BirdLife International Westrip, J.R.S.      NA 59900000             500
##   elevation_lower depth_upper depth_lower errata_flag errata_reason
## 1              NA          NA          NA          NA            NA
##   amended_flag amended_reason
## 1           NA             NA</code></pre>
<pre class="r"><code># Download red list categories for all species
redlist_status &lt;- do.call(rbind,lapply(spp,FUN=function(sp){rl_search(sp, key= MY_IUCN_REDLIST_KEY)$result}))</code></pre>
<p>Course participants can download the data from moodle and read it
in:</p>
<pre class="r"><code>redlist_status &lt;- read.table(&#39;data/UK_birds_redlist_status.csv&#39;, header=T, sep=&#39;,&#39;)</code></pre>
<p>Here is an example of the kind of information in the table. Compare
this to the information given on the IUCN website, e.g. for the <a
href="https://www.iucnredlist.org/species/22728432/132658315#conservation-actions">Balearic
Shearwater</a>.</p>
<pre><code>##              authority published_year assessment_date category criteria
## 1  (Pontoppidan, 1763)           2018      2018-08-07       LC     &lt;NA&gt;
## 2     (Linnaeus, 1758)           2018      2018-08-07       LC     &lt;NA&gt;
## 3       (Pallas, 1764)           2019      2016-10-01       LC     &lt;NA&gt;
## 4     (Linnaeus, 1758)           2019      2019-08-11       LC     &lt;NA&gt;
## 5          Brehm, 1831           2018      2018-08-07       LC     &lt;NA&gt;
## 6     (Linnaeus, 1761)           2018      2018-08-07       LC     &lt;NA&gt;
## 7     (Brünnich, 1764)           2018      2018-08-17       LC     &lt;NA&gt;
## 8     (Linnaeus, 1758)           2018      2018-08-07       LC     &lt;NA&gt;
## 9     (Linnaeus, 1758)           2018      2018-08-10       LC     &lt;NA&gt;
## 10    (Linnaeus, 1758)           2019      2018-08-09       LC     &lt;NA&gt;
##    population_trend marine_system freshwater_system terrestrial_system
## 1        Decreasing          TRUE              TRUE               TRUE
## 2        Decreasing          TRUE              TRUE               TRUE
## 3        Decreasing          TRUE              TRUE               TRUE
## 4           Unknown          TRUE              TRUE               TRUE
## 5           Unknown          TRUE              TRUE               TRUE
## 6        Increasing          TRUE             FALSE               TRUE
## 7           Unknown          TRUE             FALSE               TRUE
## 8           Unknown          TRUE             FALSE               TRUE
## 9        Increasing          TRUE             FALSE               TRUE
## 10       Increasing          TRUE              TRUE               TRUE
##                  assessor                     reviewer
## 1  BirdLife International              Westrip, J.R.S.
## 2  BirdLife International                   Martin, R.
## 3  BirdLife International Butchart, S.H.M. &amp; Symes, A.
## 4  BirdLife International                    Smith, D.
## 5  BirdLife International                   Hermes, C.
## 6  BirdLife International              Westrip, J.R.S.
## 7  BirdLife International                 Wheatley, H.
## 8  BirdLife International              Westrip, J.R.S.
## 9  BirdLife International                   Hermes, C.
## 10 BirdLife International              Westrip, J.R.S.</code></pre>
<pre class="r"><code>redlist_status[1:10,10:20]</code></pre>
<div id="iucn-population-trends" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> IUCN population
trends</h2>
<p>We have seen that range size is an important factor for classifying
species in a certain red list category. Here, we briefly analyse
population trends and range sizes. The necessary information are
contained in the red list status data frame. Of course, the extent of
occurrance (eoo) specified in the table relates to the global range size
of the species. Additionally, you can calculate the range sizes in UK
from the available distribution data.</p>
<p>Let’s first look at the relation between population trend and global
range sizes (extent of occurrence, EOO).</p>
<pre class="r"><code>library(ggplot2)

# area against trend
ggplot(data = redlist_status, mapping = aes(x = population_trend, y = eoo_km2)) + geom_boxplot() + xlab(&#39;Population trend&#39;) + ylab(&#39;Extent of occurrence [km2]&#39;)</code></pre>
<p><img src="a5_SpeciesThreats_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>If we want to plot the relation between (global) population trend and
British range sizes, we first have to calculate these ranges sizes.</p>
<pre class="r"><code># Calculate British range sizes from the distribution atlas
area &lt;- data.frame(spp=spp, area=colSums(bird_dist[,-c(1:3)]))

# Merge the range size information with the redlist table
area &lt;- merge(area, redlist_status[,c(&#39;scientific_name&#39;,&#39;population_trend&#39;,&#39;eoo_km2&#39;)],by.x=&#39;spp&#39;,by.y=&#39;scientific_name&#39;)
ggplot(data = area, mapping = aes(x = population_trend, y = area*100)) + geom_boxplot() + xlab(&#39;Population trend&#39;) + ylab(&#39;Distribution area [km2] in UK&#39;)</code></pre>
<p><img src="a5_SpeciesThreats_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<p>The redlist table also contains information, for example on realm
(marine, freshwater, terrestrial) or on elevation/depth.</p>
<ul>
<li>Plot the relationship between population trend and range size
separately for marine, freshwater, and terrestrial species.</li>
<li>Plot the relationship between population trend and range size
separately for lowland and highland species.</li>
</ul>
</div>
</div>
<div id="mapping-hotspots-of-threatened-species" class="section level2"
number="1.2">
<h2><span class="header-section-number">1.2</span> Mapping hotspots of
threatened species</h2>
<p>Next, I would like to analyse the distribution of threatened species.
We can find the relevant red list information in the data frame on the
red list status. Then, we need to combine this red list information with
the distribution data. To this end, we will have to extract all species
that belong to a specific threat category, then compute the species
richness of these species per cell and map this.</p>
<p>For example, we can extract all species that are classified as
vulnerable:</p>
<pre class="r"><code>(subset(redlist_status,category==&#39;VU&#39;)$scientific_name)</code></pre>
<pre><code>## [1] &quot;Branta ruficollis&quot;   &quot;Aythya ferina&quot;       &quot;Rissa tridactyla&quot;   
## [4] &quot;Fratercula arctica&quot;  &quot;Streptopelia turtur&quot;</code></pre>
<p>Using the red list information we can then map hotspots of species,
meaning the species richness of species falling into different red list
categories.</p>
<pre class="r"><code>library(terra)
library(tidyterra)  # for mapping

# The coordinate reference system for the UK National Grid is:
proj_UK &lt;- &#39;+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs&#39;

# Identify all vulnerable species 
vu_spp &lt;- subset(redlist_status,category==&#39;VU&#39;)$scientific_name
# We have to make sure that species names are written in the same way in the redlist and distribution data
vu_spp &lt;- sub(&#39; &#39;,&#39;_&#39;, intersect(vu_spp,spp))

# Identify all least concern species
lc_spp &lt;- subset(redlist_status,category==&#39;LC&#39;)$scientific_name
lc_spp &lt;- sub(&#39; &#39;,&#39;_&#39;, intersect(lc_spp,spp))

# Now, we extract the distribution data for the VU and LC species groups, make SpatRasters and stack these
spp_maps &lt;- c(
  terra::rast(data.frame(bird_dist[,2:3], log_VU=log(rowSums(bird_dist[,vu_spp]))), crs=proj_UK, type=&#39;xyz&#39;),
  terra::rast(data.frame(bird_dist[,2:3], log_LC=log(rowSums(bird_dist[,lc_spp]))), crs=proj_UK, type=&#39;xyz&#39;))

# Plot the maps
ggplot() +
  geom_spatraster(data = spp_maps) +
  facet_wrap(~lyr, ncol = 2) +
 scale_fill_whitebox_c(
    palette = &quot;muted&quot;
  ) +
  labs(
    fill = &quot;log(richness)&quot;,
    title = &quot;Richness per red list category&quot;
  )</code></pre>
<p><img src="a5_SpeciesThreats_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<p>Map species richness of all species belonging to the threatened
categories (CR, EN, VU) and species richness of all species belonging to
the non-threatened categories (NT, LC).</p>
<ul>
<li>Discuss the patterns. Where are hotspots of threatened species?</li>
</ul>
</div>
</div>
</div>
<div id="red-list-threats" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Red list threats</h1>
<p>The IUCN also assesses the main threats per species as you saw in the
<a
href="https://www.iucnredlist.org/species/22728432/132658315#conservation-actions">Balearic
Shearwater</a> example. The Threat Classification Scheme can be found <a
href="https://www.iucnredlist.org/resources/threat-classification-scheme">here</a>.</p>
<p>If you have your own IUCN API key, you can easily download the
information on species’ red list threats:</p>
<pre class="r"><code># Download red list threats for single species
rl_threats(&#39;Gavia stellata&#39;, key= MY_IUCN_REDLIST_KEY)</code></pre>
<pre><code>## $name
## [1] &quot;Gavia stellata&quot;
## 
## $result
##    code                                          title  timing
## 1  11.1                  Habitat shifting &amp; alteration  Future
## 2   3.3                               Renewable energy Ongoing
## 3   4.3                                 Shipping lanes Ongoing
## 4   5.4         Fishing &amp; harvesting aquatic resources Ongoing
## 5 5.4.4 Unintentional effects: (large scale) [harvest] Ongoing
## 6   9.2                Industrial &amp; military effluents Ongoing
## 7 9.2.1                                     Oil spills Ongoing
##               scope                   severity         score invasive
## 1 Majority (50-90%)        Negligible declines Low Impact: 3       NA
## 2   Minority (&lt;50%)                    Unknown       Unknown       NA
## 3   Minority (&lt;50%)        Negligible declines Low Impact: 4       NA
## 4   Minority (&lt;50%)        Negligible declines Low Impact: 4       NA
## 5   Minority (&lt;50%)        Negligible declines Low Impact: 4       NA
## 6   Minority (&lt;50%) Slow, Significant Declines Low Impact: 5       NA
## 7   Minority (&lt;50%) Slow, Significant Declines Low Impact: 5       NA</code></pre>
<pre class="r"><code># Download red list threats for all species
redlist_threats &lt;- do.call(rbind,lapply(seq_len(length(spp)),FUN=function(i){xi &lt;- rl_threats(spp[i], key= MY_IUCN_REDLIST_KEY); if(length(xi$result)) {data.frame(species=spp[i],xi$result) }}))</code></pre>
<p>Course participants can download the data from moodle and read it
in:</p>
<pre class="r"><code>redlist_threats &lt;- read.table(&#39;data/UK_birds_redlist_threats.csv&#39;, header=T, sep=&#39;,&#39;)</code></pre>
<p>The threats are ordered hierarchically from broad threat type to very
detailed threat, e.g.:</p>
<ul>
<li><em>2 Agriculture &amp; aquaculture</em> &gt; <em>2.2 Wood &amp;
pulp plantations </em> &gt; <em>2.2.1 Small-holder plantations</em></li>
<li><em>5 Biological resource use</em> &gt; <em>5.4 Fishing &amp;
harvesting aquatic resources</em> &gt; <em>5.4.3 Unintentional effects:
subsistence/small scale (species being assessed is not the
target)[harvest]</em></li>
</ul>
<p>Here is an example of the kind of information in the table. For more
details, please have a look at the IUCN website, e.g. the <a
href="https://www.iucnredlist.org/species/22728432/132658315#conservation-actions">Balearic
Shearwater</a> example, and at the <a
href="https://www.iucnredlist.org/resources/threat-classification-scheme">Threat
Classification Scheme</a>.</p>
<pre class="r"><code>redlist_threats[sample(nrow(redlist_threats),10),-c(1:2)]</code></pre>
<pre><code>##                                                               title  timing
## 576                         Intentional use (species is the target) Ongoing
## 726                                    Livestock farming &amp; ranching Ongoing
## 716               Unintentional effects (species is not the target) Ongoing
## 571                      Agro-industry grazing, ranching or farming Ongoing
## 544                                               Roads &amp; railroads Ongoing
## 32  Invasive non-native/alien species/diseases (Unspecified Rattus) Ongoing
## 240                      Abstraction of surface water (unknown use) Ongoing
## 202  Invasive non-native/alien species/diseases (Perca fluviatilis) Ongoing
## 436     Invasive non-native/alien species/diseases (Neovison vison) Ongoing
## 62                                Agricultural &amp; forestry effluents Ongoing
##                 scope                         severity            score
## 576   Minority (&lt;50%)       Slow, Significant Declines    Low Impact: 5
## 726 Majority (50-90%)       Slow, Significant Declines Medium Impact: 6
## 716   Minority (&lt;50%)              Negligible declines    Low Impact: 4
## 571 Majority (50-90%)       Slow, Significant Declines Medium Impact: 6
## 544   Minority (&lt;50%) Causing/Could cause fluctuations    Low Impact: 5
## 32    Minority (&lt;50%)              Negligible declines    Low Impact: 4
## 240 Majority (50-90%)              Negligible declines    Low Impact: 5
## 202   Minority (&lt;50%)              Negligible declines    Low Impact: 4
## 436   Minority (&lt;50%)       Slow, Significant Declines    Low Impact: 5
## 62    Minority (&lt;50%)       Slow, Significant Declines    Low Impact: 5
##               invasive
## 576               &lt;NA&gt;
## 726               &lt;NA&gt;
## 716               &lt;NA&gt;
## 571               &lt;NA&gt;
## 544               &lt;NA&gt;
## 32  Unspecified Rattus
## 240               &lt;NA&gt;
## 202  Perca fluviatilis
## 436     Neovison vison
## 62                &lt;NA&gt;</code></pre>
<p>We can extract many useful information from this table, for example,
when specific threats occurred.</p>
<pre class="r"><code>table(redlist_threats$timing)</code></pre>
<pre><code>## 
##                   Future                  Ongoing   Past, Likely to Return 
##                       58                      750                       18 
## Past, Unlikely to Return 
##                        8</code></pre>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<p>Explore the threats table. For example,</p>
<ul>
<li>Pick a species and identify which threats are causing rapid declines
and slow declines.</li>
</ul>
</div>
<div id="mapping-hotspots-of-threats" class="section level2"
number="2.1">
<h2><span class="header-section-number">2.1</span> Mapping hotspots of
threats</h2>
<p>We can also analyse the spatial distribution of threats. To do so, we
need to extract the species that are affected by a particular threat in
a particular time period. Then we can extract the distribution data for
these species, compute the species richness and map this in space.</p>
<pre class="r"><code># Which ongoing threats are the most common ?
sort(table(subset(redlist_threats, species %in% spp &amp; timing==&#39;Ongoing&#39;)$title), decreasing=T)[1:10]</code></pre>
<pre><code>## 
##         Hunting &amp; trapping terrestrial animals 
##                                             63 
##        Intentional use (species is the target) 
##                                             40 
##                Industrial &amp; military effluents 
##                                             26 
##              Agricultural &amp; forestry effluents 
##                                             24 
##            Annual &amp; perennial non-timber crops 
##                                             23 
## Unintentional effects: (large scale) [harvest] 
##                                             23 
##                          Agro-industry farming 
##                                             21 
##         Fishing &amp; harvesting aquatic resources 
##                                             21 
##                               Renewable energy 
##                                             21 
##                      Herbicides and pesticides 
##                                             20</code></pre>
<pre class="r"><code># Identify the species experiencing threats from hunting
spp_threat1 &lt;- sub(&#39; &#39;,&#39;_&#39;,subset(redlist_threats,title==&quot;Hunting &amp; trapping terrestrial animals&quot; &amp; species %in% spp)$species)
# Identify the species experiencing threats from industry and military
spp_threat2 &lt;- sub(&#39; &#39;,&#39;_&#39;,subset(redlist_threats,title==&quot;Industrial &amp; military effluents&quot; &amp; species %in% spp)$species)

# Map species experiencing threats from hunting
plot(terra::rast(data.frame(bird_dist[,2:3],rowSums(bird_dist[,spp_threat1])), crs=proj_UK, type=&#39;xyz&#39;), main=&quot;Hunting &amp; trapping terrestrial animals&quot;)</code></pre>
<p><img src="a5_SpeciesThreats_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># species experiencing threats from industry and military
plot(terra::rast(data.frame(bird_dist[,2:3],rowSums(bird_dist[,spp_threat2])), crs=proj_UK, type=&#39;xyz&#39;), main=&quot;Industrial &amp; military effluents&quot;)</code></pre>
<p><img src="a5_SpeciesThreats_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<div class="alert alert-info">
<p><strong>Exercise:</strong></p>
<ul>
<li>Pick two other ongoing threats and map the species richness of those
breeding birds affected by these threats.</li>
<li>Pick a future and a past threat and map the species richness of
those breeding birds affected by these threats.</li>
</ul>
<p>Interpret.</p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-IUCN2012" class="csl-entry">
IUCN. 2012. <em>IUCN Red List Categories and Criteria: Version 3.1.</em>
Gland, Switzerland; Cambridge, UK: IUCN.
</div>
<div id="ref-IUCN2019" class="csl-entry">
———. 2019. <em>The <span>IUCN</span> Red List of Threatened Species.
Version 2019-2.</em> http://www.iucnredlist.org. Downloaded on 27
October 2019.
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell 2022 <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
