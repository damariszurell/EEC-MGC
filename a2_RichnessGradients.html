<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Species richness gradients</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Macroecology and global change</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: macroecological analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="a0_setup.html">0. Getting started</a>
    </li>
    <li>
      <a href="a1_SpatialData.html">1. Spatial data in R</a>
    </li>
    <li>
      <a href="a2_RichnessGradients.html">2. Species richness gradients</a>
    </li>
    <li>
      <a href="a3_RichnessRegression.html">3. Species richness regression</a>
    </li>
    <li>
      <a href="a4_RangeMaps.html">4. Species range maps</a>
    </li>
    <li>
      <a href="a5_SpeciesThreats.html">5. Species threats</a>
    </li>
    <li>
      <a href="a6_BiodivChanges.html">6. Analysing biodiversity changes</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: species distribution modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="b1_SpeciesData.html">1. Species data</a>
    </li>
    <li>
      <a href="b2_EnvData.html">2. Environmental data</a>
    </li>
    <li>
      <a href="b3_SDM_intro.html">3. SDMs: simple model fitting</a>
    </li>
    <li>
      <a href="b4_SDM_eval.html">4. SDMs: assessment and prediction</a>
    </li>
    <li>
      <a href="b5_pseudoabsence.html">5. Pseudo-absence and background data</a>
    </li>
    <li>
      <a href="b6_SDM_algorithms.html">6. SDMs: algorithms</a>
    </li>
    <li>
      <a href="b7_SDM_ensembles.html">7. SDMs: ensembles</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uni-potsdam.de/en/ibb-macroecology/index">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Species richness gradients</h1>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<hr />
<div class="alert alert-info">
<p><strong>RStudio project</strong></p>
<p>Open the RStudio project that we created in the first session. I
recommend to use this RStudio project for the entire course and within
the RStudio project create separate R scripts for each session.</p>
<ul>
<li>Create a new empty R script by going to the tab “File”, select “New
File” and then “R script”</li>
<li>In the new R script, type
<code># Session a2: Species richness gradients</code> and save the file
in your folder “scripts” within your project folder, e.g. as
“a2_RichnessGradients.R”</li>
</ul>
</div>
<p>Today, we will explore species richness gradients in UK breeding
birds. We will map species richness, explore the latitudinal species
richness gradient, and the species-energy relationships.</p>
<div id="breeding-bird-richness" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Breeding bird
richness</h1>
<div id="distribution-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Distribution
data</h2>
<p>All analyses of today will be based on a dataset of British breeding
and wintering birds recently made available by <span
class="citation">Gillings et al. (2019)</span>. The original data
contain breeding bird records in 20-year cycles (1968-1972, 1988-1991,
2008-2011) and wintering bird records in 30-year cycles
(1981/1982-1983-1984, 2007/2008-2010/2011) at a 10 km spatial resolution
throughout Britain, Ireland, the Isle of Man and the Channel Islands.
Some rarer species are represented at 20 or 50 km resolutions. Here, we
will concentrate on bird records from Britain at 10 km resolution during
the breeding seasons 2008-2011. The original data are available through
the British Trust of Ornithology (www.bto.org; direct download <a
href="https://www.bto.org/sites/default/files/atlas_open_data_files.zip">here</a>).
To simplify matters, I have already filtered the data to contain only
the relevant breeding records. These cleaned data are available <a
href="data/UK_BBatlas_2008.csv">here</a>. Please download the data and
save them in an appropriate folder (e.g. in <em>data</em> folder).</p>
<p>We can now read in the data into R.</p>
<pre class="r"><code># Read in the distribution dataset:
bird_dist &lt;- read.table(&#39;data/UK_BBatlas_2008.csv&#39;,header=T, sep=&#39;,&#39;, stringsAsFactors = F)</code></pre>
<p>Let’s take a first look at the data and find out what information is
contained in there.</p>
<pre class="r"><code>str(bird_dist, list.len=10)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2833 obs. of  230 variables:
##  $ grid                         : chr  &quot;HP40&quot; &quot;HP50&quot; &quot;HP51&quot; &quot;HP60&quot; ...
##  $ EASTING                      : int  445000 455000 455000 465000 465000 395000 395000 415000 415000 415000 ...
##  $ NORTHING                     : int  1205000 1205000 1215000 1205000 1215000 1135000 1145000 1145000 1155000 1165000 ...
##  $ Gavia_stellata               : int  0 1 1 1 1 1 1 0 1 1 ...
##  $ Gavia_arctica                : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Tachybaptus_ruficollis       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Podiceps_cristatus           : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Podiceps_nigricollis         : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Fulmarus_glacialis           : int  1 1 1 1 1 1 1 0 1 1 ...
##  $ Puffinus_puffinus            : int  0 0 0 0 0 0 0 0 0 0 ...
##   [list output truncated]</code></pre>
<p>The data frame contains 230 columns of which the first three columns
describe the grid reference and coordinates. The coordinates are
provided in the British National Grid, with grid letters and grid
digits. The British National Grid is based on a transverse Mercator
projection, and the grid letters and grid digits can easily be converted
into the so-called Easting and Northing coordinates. All other columns
contain presence and absence data of 227 bird species for the breeding
seasons 2008-2011. The data contain only species presences with probable
or confirmed breeding. The column names are the latin species names.</p>
<p>Let’s plot the spatial distribution of the Willow ptargmigan
(<em>Lagopus lagopus</em>). As the data are provided for all grid cells
in Britain without any holes, we can use the convenient
<code>rast</code>()<code>function in the</code>terra` package for
converting the data frame into raster data.</p>
<pre class="r"><code>library(terra)

# The coordinate reference system for the UK National Grid is:
proj_UK &lt;- &#39;+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs&#39;

r_ptarmigan &lt;- terra::rast(bird_dist[,c(&#39;EASTING&#39;,&#39;NORTHING&#39;,&#39;Lagopus_lagopus&#39;)], crs=proj_UK, type = &quot;xyz&quot;)

plot(r_ptarmigan)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="species-richness-patterns" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Species richness
patterns</h2>
<p>Now, we map the species richness of breeding birds in Britain. As you
have seen, the data frame contains presence and absence records for all
breeding bird species for each 10 km cell in Britain. We can use the
function <code>rowSums()</code> to sum up the number of bird species
present at any location (in each row). But be careful to only sum up the
columns containing species records, not the columns containing
coordinates.</p>
<pre class="r"><code>richness &lt;- data.frame(bird_dist[,2:3], richness = rowSums(bird_dist[,-c(1:3)]))
head(richness)</code></pre>
<pre><code>##   EASTING NORTHING richness
## 1  445000  1205000       12
## 2  455000  1205000       41
## 3  455000  1215000       25
## 4  465000  1205000       36
## 5  465000  1215000       47
## 6  395000  1135000       43</code></pre>
<p>Again, we can use the <code>rast</code>()` function from above to
convert this new data frame into a raster object and map this.</p>
<pre class="r"><code>r_richness &lt;- terra::rast(richness, crs = proj_UK, type = &quot;xyz&quot;)
plot(r_richness)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="alert alert-success" role="alert">
<p>How is bird species richness distributed in Britain?</p>
</div>
</div>
<div id="task-2-latitudinal-species-richness-gradient"
class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Task 2: Latitudinal
species richness gradient</h2>
<p>As was discussed in the Macroecology lecture, we can analyse
different aspects of spatial patterns in species richness <span
class="citation">(Gaston 2000)</span>. First, we plot the latitudinal
species richness gradient. For simplicity, we use the Northing
coordinates provided in the data frame rather than longitude. The
smoothing line gives a first indication whether there are any strong
trends.</p>
<pre class="r"><code>library(ggplot2)
ggplot(data = richness, mapping = aes(x = NORTHING, y = richness)) + 
  geom_point() + 
  geom_smooth(method=&quot;loess&quot;) + 
  xlab(&#39;Latitude (UK NORTHING)&#39;) + 
  ylab(&#39;Species richness&#39;)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="alert alert-success" role="alert">
<p>Compare your latitudinal richness gradient with <span
class="citation">Gaston (2000)</span> and discuss.</p>
</div>
</div>
<div id="species-energy-relationships" class="section level2"
number="1.4">
<h2><span class="header-section-number">1.4</span> Species-energy
relationships</h2>
<p><span class="citation">Gaston (2000)</span> also presented
species-energy relationship, for example the relationship between
species richness and annual temperature. For this, we need to join the
species richness data with climatic data. For convenience, I have
already processed worldclim data (19 bioclimatic variables) for you such
that the raster stack is projected in the British National Grid at 10 km
spatial resolution. You can download the raster stack data <a
href="data/UK_bioclim.zip">here</a>. Please save it in your
<em>data</em> folder and unzip it. We can then load the raster data in
R:</p>
<pre class="r"><code>clim &lt;- terra::rast(&#39;data/UK_bioclim.grd&#39;)
plot(clim)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>To plot the relationship between species richness and summer
temperature, we have to extract the climate data for all cells in
Britain and join these with the species richness data.</p>
<div class="alert alert-success" role="alert">
<p>Look up the definition of the bioclimatic variables again. Which one
is summer temperature?</p>
</div>
<pre class="r"><code># Extract climate data and join with richness data frame
richness2 &lt;- cbind(richness, terra::extract(clim, richness[,1:2]))

# Plot species richness against summer temperature
ggplot(data = richness2, mapping = aes(x = bio10/10, y = richness)) + 
  geom_point() + 
  geom_smooth(method=&quot;loess&quot;) + 
  xlab(&#39;Summer temperature [°C]&#39;) + 
  ylab(&#39;Species richness&#39;)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Dont’ forget to save the species-climate data frame for later:</p>
<pre class="r"><code>save(richness2,file=&#39;data/UK_bird_richness_clim.RData&#39;)</code></pre>
<div class="alert alert-success" role="alert">
<p>Compare this species-energy relationship with <span
class="citation">Gaston (2000)</span> and discuss.</p>
</div>
</div>
</div>
<div id="more-richness-patterns" class="section level1" number="2">
<h1><span class="header-section-number">2</span> More richness
patterns</h1>
<p>As mentioned at the beginning of this practical, distribution data of
UK breeding birds are available for different decades. Again, I have
already processed the data and you can download them <a
href="data/UK_BBatlas_1968_2008.csv">here</a>. Place the data into your
<em>data</em> folder.</p>
<pre class="r"><code># Read in the distribution dataset:
bird_dist2 &lt;- read.table(&#39;data/UK_BBatlas_1968_2008.csv&#39;,header=T, sep=&#39;,&#39;, stringsAsFactors = F)

# Look at data, the first three columns contain coordinate information, the 4th column contains the time periods:
head(bird_dist2[,1:20])</code></pre>
<pre><code>##   grid EASTING NORTHING  period Gavia_stellata Gavia_arctica
## 1 HP40  445000  1205000 1968-72              1             0
## 2 HP40  445000  1205000 1988-91              1             0
## 3 HP40  445000  1205000 2008-11              0             0
## 4 HP50  455000  1205000 1988-91              1             0
## 5 HP50  455000  1205000 2008-11              1             0
## 6 HP50  455000  1205000 1968-72              1             0
##   Tachybaptus_ruficollis Podiceps_cristatus Podiceps_nigricollis
## 1                      0                  0                    0
## 2                      0                  0                    0
## 3                      0                  0                    0
## 4                      0                  0                    0
## 5                      0                  0                    0
## 6                      0                  0                    0
##   Fulmarus_glacialis Puffinus_puffinus Hydrobates_pelagicus
## 1                  1                 0                    0
## 2                  1                 0                    0
## 3                  1                 0                    1
## 4                  1                 0                    0
## 5                  1                 0                    0
## 6                  1                 0                    0
##   Oceanodroma_leucorhoa Morus_bassanus Phalacrocorax_carbo
## 1                     0              0                   0
## 2                     0              0                   0
## 3                     1              0                   0
## 4                     0              0                   0
## 5                     0              0                   0
## 6                     0              0                   0
##   Phalacrocorax_aristotelis Botaurus_stellaris Ixobrychus_minutus
## 1                         1                  0                  0
## 2                         1                  0                  0
## 3                         1                  0                  0
## 4                         1                  0                  0
## 5                         1                  0                  0
## 6                         1                  0                  0
##   Egretta_garzetta Ardea_cinerea
## 1                0             0
## 2                0             0
## 3                0             0
## 4                0             0
## 5                0             0
## 6                0             0</code></pre>
<pre class="r"><code># Species names are contained in the remaining columns:
spp &lt;- names(bird_dist2)[-c(1:4)]
spp_names &lt;- sub(&#39;_&#39;,&#39; &#39;,spp)</code></pre>
<p>Again, we can calculate species richness by simply summing up each
row. However, we need to take care to use the correct years.</p>
<p>First, I would like to analyse how species richness has changed
between different time periods. For this, we first need to compute
species richness per time period, for example:</p>
<pre class="r"><code># Which time periods are contained in the data?
unique(bird_dist2$period)</code></pre>
<pre><code>## [1] &quot;1968-72&quot; &quot;1988-91&quot; &quot;2008-11&quot;</code></pre>
<pre class="r"><code># Extract species occurrences per time period and compute species richness:
birds_68 &lt;- subset(bird_dist2,period==&#39;1968-72&#39;)
birds_68$richness68 &lt;- rowSums(birds_68[,spp])

# Convert to raster data and map:
plot(terra::rast(birds_68[,c(&#39;EASTING&#39;,&#39;NORTHING&#39;,&#39;richness68&#39;)], crs=proj_UK, type = &quot;xyz&quot;))</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="alert alert-info">
<p><em><strong>Exercise:</strong></em></p>
<ul>
<li>Calculate species richness for all time periods and map them. The
maps below are done by first creating a multi-layer SpatRaster object
´dist_maps´ with <code>c()</code> and then using the code below. Of
course, you can also plot the maps separately.</li>
<li>Plot the latitudinal species richness gradients for at least one
other time period.</li>
<li>Plot species richness against annual precipitation sum. Compare with
<span class="citation">Gaston (2000)</span> and discuss.</li>
</ul>
</div>
<p>UK breeding bird richness mapped for all time periods:</p>
<pre class="r"><code>library(tidyterra)

# Make a SpatRaster object &quot;dist_maps&quot; containing the species richness layers for the three time periods
# Map the species richness maps for the 3 time periods:
ggplot() +
  geom_spatraster(data = dist_maps) +
  facet_wrap(~lyr, ncol = 3) +
 scale_fill_whitebox_c(
    palette = &quot;muted&quot;
  ) +
  labs(fill = &quot;Richness&quot;)</code></pre>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Latitudinal species richness gradient in UK breeding birds across
different time periods:</p>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Species-energy relationship of UK breeding birds across different
time periods:</p>
<p><img src="a2_RichnessGradients_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gaston2000a" class="csl-entry">
Gaston, K. J. 2000. <span>“Global Patterns in Biodiversity.”</span>
<em>Nature</em> 405: 220–27. <a
href="https://doi.org/10.1038/35012228">https://doi.org/10.1038/35012228</a>.
</div>
<div id="ref-Gillings2019" class="csl-entry">
Gillings, S., D. E. Balmer, B. J. Caffrey, I. S. Downie, D. W. Gibbons,
P. C. Lack, J. B. Reid, J. T. R. Sharrock, R. L. Swann, and R. J.
Fuller. 2019. <span>“Breeding and Wintering Bird Distributions in
Britain and Ireland from Citizen Science Bird Atlases.”</span>
<em>Global Ecology and Biogeography</em> 28 (7): 866–74. <a
href="https://doi.org/10.1111/geb.12906">https://doi.org/10.1111/geb.12906</a>.
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell 2022 <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
